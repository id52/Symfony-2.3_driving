{% extends "AppBundle::admin.html.twig" %}

{% block content %}
    <h3 xmlns="http://www.w3.org/1999/html">{{ (app.request.get('_route') == router_item_edit ? ('admin.'~entity_name_s~'_edit_title') : ('admin.'~entity_name_s~'_add_title'))|trans }}</h3>
    <hr>

    {{ form_start(form) }}
    {{ form_widget(form) }}

    {% if regions %}
    <fieldset>
        <legend>{{ 'service_prices_in_regions'|trans }}:</legend>
        <div class="control-group">
            <label class="control-label"> </label>
            <div class="controls">
                <div class="span1">main</div>
                <div class="span1 e_prices">comb</div>
                <div class="span1 e_prices">expr</div>
            </div>
        </div>
        {% for region in regions %}
        <div class="control-group">
            <label for="price_{{ region.id }}" class="control-label">{{ region.name }}:</label>
            <div class="controls">
                <div class="input-append">
                    <input value="{{ prices[region.id] is defined ? prices[region.id] : 0 }}" type="text" class="span1 {% if service is defined and service.type == 'training' %} second-price{% endif %}" name="prices[{{ region.id }}]" id="price_{{ region.id }}">
                    <span class="add-on">{{ 'RUB'|trans }}</span>
                </div>

                <div class="input-append e_prices">
                    <input value="{{ prices_comb[region.id] is defined ? prices_comb[region.id] : 0 }}" type="text" class="span1 {% if service is defined and service.type == 'training' %} second-price{% endif %}" name="prices_comb[{{ region.id }}]" id="price_comb_{{ region.id }}">
                    <span class="add-on">{{ 'RUB'|trans }}</span>
                </div>
                <div class="input-append e_prices">
                    <input value="{{ prices_expr[region.id] is defined ? prices_expr[region.id] : 0 }}" type="text" class="span1 {% if service is defined and service.type == 'training' %} second-price{% endif %}" name="prices_expr[{{ region.id }}]" id="price_expr_{{ region.id }}">
                    <span class="add-on">{{ 'RUB'|trans }}</span>
                </div>

                <label class="a_prices" style="display:inline-block"><input {{ prices_active[region.id] is defined and prices_active[region.id] ? 'checked="checked"' : '' }} name="prices_active[{{ region.id }}]" type="checkbox" /> Активна?</label>
            </div>
        </div>
        {% endfor %}
    </fieldset>
    {% endif %}

    <div class="form-actions">
        <button type="submit" class="btn btn-success">
            <i class="fa fa-download"></i>
            <span>{{ 'admin.buttons.save'|trans }}</span>
        </button>
        {% if app.request.get('_route') == router_item_edit %}
            <a href="{{ path(router_item_delete, { id: entity.id }) }}" class="btn btn-danger" onclick="return confirm('{{ 'you_sure'|trans }}')">
                <i class="fa fa-trash-o"></i> <span>{{ 'admin.buttons.delete'|trans }}</span>
            </a>
        {% endif %}
        <a class="btn pull-right" href="{{ path(router_list) }}"><i class="fa fa-arrow-left"></i> {{ 'admin.buttons.back_to_list'|trans }}</a>
    </div>
    {{ form_end(form) }}
{% endblock content %}

{% block js %}
<script>
$(function() {
    var type = function() {
        var is_training = $('#service_type').val() == 'training';
        $('.e_prices').toggle(is_training);
        $('.a_prices').toggle(!is_training);
    };
    type();
    $('#service_type').change(type);
});
</script>
{% endblock js %}
